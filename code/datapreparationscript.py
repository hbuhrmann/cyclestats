import sourcetocsv as cycle
import pandas as pd

####################################################################################
# TAKE ALL THE GPX,TCX and FIT source files and convert them to individual CSV files
#####################################################################################

def runStep1():
    inputpath = '/Users/hbuhrmann/PycharmProjects/CycleStats/CycleData'
    outputpath = '/Users/hbuhrmann/PycharmProjects/CycleStats/CycleDataConverted'
    cycle.convertgeofilesbatch(inputpath, outputpath)

######################################################################################
# Take a list of standardised CSV files and create a single CSV file with all the data
######################################################################################
#########    THE BELOW LIST IS FOR RICHMOND ##########################################

def runStep2():
    pathname = '/Users/hbuhrmann/PycharmProjects/CycleStats/CycleDataConverted/'
    filelist = [
        '_fit316436609.csv',
        '_fit314750266.csv',
        '_fit235754964.csv',
        '_fit292874968.csv',
        '_fit132521637.csv',
        '_fit174428563.csv',
        '_fit320776083.csv',
        '_fit314750502.csv',
        '_fit314750657.csv',
        '_fit434529725.csv',
        '_fit92925470.csv',
        '_fit314750835.csv',
        '_fit2665288192.csv',
        '_fit2754517219.csv',
        '_fit316436588.csv',
        '_fit229212343.csv',
        '_fit75406895.csv',
        '_fit41902330.csv',
        '_fit41902255.csv',
        '_fit271644920.csv',
        '_fit179036708.csv',
        '_fit41902387.csv',
        '_fit66737350.csv',
        '_fit41902172.csv',
        '_fit44024127.csv',
        '_fit92925484.csv',
        '_fit41902234.csv',
        '_fit92925563.csv',
        '_fit204368754.csv',
        '_fit271644947.csv',
        '_fit265445729.csv',
        '_fit43420889.csv',
        '_fit429013665.csv',
        '_fit92925478.csv',
        '_fit52787078.csv',
        '_fit92925530.csv',
        '_fit81889914.csv',
        '_fit41902310.csv',
        '_fit190415250.csv',
        '_fit203444225.csv',
        '_fit337156571.csv',
        '_fit92925453.csv',
        '_fit66737316.csv',
        '_fit429990832.csv',
        '_fit51827785.csv',
        '_fit70092189.csv',
        '_fit2552738910.csv',
        '_fit191388628.csv',
        '_fit2398260144.csv',
        '_fit2705294525.csv',
        '_fit429013630.csv',
        '_fit48623477.csv',
        '_fit545815530.csv',
        '_fit1024443285.csv',
        '_fit1247767302.csv',
        '_fit43420876.csv',
        '_fit2452523671.csv',
        '_fit41902281.csv',
        '_fit41902167.csv',
        '_fit616179786.csv',
        '_fit2550104210.csv',
        '_fit41902343.csv',
        '_fit41902360.csv',
        '_fit616179845.csv',
        '_fit41902418.csv',
        '_fit2432771829.csv',
        '_fit81889907.csv',
        '_fit1247767418.csv',
        '_fit41902372.csv',
        '_fit1875779694.csv',
        '_fit132521643.csv',
        '_fit2570074547.csv',
        '_fit132521651.csv',
        '_fit631757246.csv',
        '_fit2564122774.csv',
        '_fit222916009.csv',
        '_fit207905635.csv',
        '_fit337156544.csv',
        '_fit262857121.csv',
        '_fit47729142.csv',
        '_gpxWindy_Morning_Ride.csv',
        '_gpxWindy_Morning_Ride (1).csv',
        '_fit1716079331.csv',
        '_fit647504618.csv',
        '_fit2820565050.csv',
        '_fit41902422.csv',
        '_fit1247767618.csv',
        '_fit2531109046.csv',
        '_fit1247767198.csv',
        '_fit377021089.csv',
        '_fit2449206576.csv',
        '_fit616683920.csv',
        '_fit47729150.csv',
        '_fit229212358.csv',
        '_fit444953730.csv',
        '_fit1247767566.csv',
        '_fit1751013743.csv',
        '_fit204368743.csv',
        '_fit401007730.csv',
        '_fit2820564963.csv',
        '_fit256420978.csv',
        '_fit2457598697.csv',
        '_fit253538033.csv',
        '_fit662096823.csv',
        '_fit1525290224.csv',
        '_fit1024443226.csv',
        '_fit1247767886.csv',
        '_fit401007888.csv',
        '_fit417875468.csv',
        '_fit1247766712.csv',
        '_fit41902340.csv',
        '_fit174428583.csv',
        '_fit1261644295.csv',
        '_fit132521641.csv',
        '_fit1247766150.csv',
        '_fit171151354.csv',
        '_fit41902161.csv',
        '_fit1247768010.csv',
        '_fit1247767496.csv',
        '_fit41902228.csv',
        '_fit609664370.csv',
        '_fit609664368.csv',
        '_fit1795027448.csv',
        '_fit1857981254.csv',
        '_fit314750224.csv',
        '_fit545814898.csv',
        '_fit282263511.csv',
        '_fit1024443315.csv',
        '_fit262738012.csv',
        '_fit1024443393.csv',
        '_fit132521652.csv',
        '_fit1261644319.csv',
        '_fit1247768072.csv',
        '_fit1024443169.csv',
        '_fit609664332.csv',
        '_fit609664316.csv',
        '_fit41902345.csv',
        '_fit495298750.csv',
        '_fit207905647.csv',
        '_fit609664338.csv',
        '_fit229212367.csv',
        '_fit2531108987.csv',
        '_fit546072723.csv',
        '_fit41902419.csv',
        '_fit1024443800.csv',
        '_fit1829129118.csv',
        '_fit545814954.csv',
        '_fit262738005.csv',
        '_fit1829129025.csv',
        '_fit1538000242.csv',
        '_fit51827772.csv',
        '_fit50627481.csv',
        '_fit395289966.csv',
        '_fit561139947.csv',
        '_fit1846012057.csv',
        '_fit1846012148.csv',
        '_fit2998662521.csv',
        '_fit372779680.csv',
        '_fit1247767246.csv',
        '_fit401007761.csv',
        '_fit429013645.csv',
        '_fit1687732412.csv',
        '_fit50627490.csv',
        '_fit1879148194.csv',
        '_fit1024443458.csv',
        '_fit2998662532.csv',
        '_fit609664375.csv',
        '_fit609664323.csv',
        '_fit545815148.csv',
        '_fit545815478.csv',
        '_fit92925549.csv',
        '_fit70092200.csv',
        '_fit2415615872.csv',
        '_fit2998662514.csv',
        '_fit1535437559.csv',
        '_fit81889951.csv',
        '_fit1247767005.csv',
        '_fit545815454.csv',
        '_fit325954809.csv',
        '_fit2415615921.csv',
        '_fit1257809360.csv',
        '_fit662096842.csv',
        '_fit401007814.csv',
        '_fit1829129091.csv',
        '_fit1879148151.csv',
        '_fit624786858.csv',
        '_fit1958497095.csv',
        '_fit51827795.csv',
        '_fit48623471.csv',
        '_fit2757749280.csv',
        '_fit92925536.csv',
        '_fit75406909.csv',
        '_fit2570074449.csv',
        '_fit1829129036.csv'
    ]

    cycledf = cycle.readcyclecsv(pathname,filelist)
    cycledf2 = cycle.addcomputedclimbdata2(cycledf)
    cycledf2[cycledf2['IncludeIn2']==1].to_csv('/Users/hbuhrmann/PycharmProjects/CycleStats/TestResults2/eastsussex_final.csv')

def listfilesingeo():

    #Richmond Top Left = 51.456435, -0.308058
    #Richmond Top Right = 51.456435, -0.252830
    #Richmond Bottom Left = 51.421213, -0.308058
    #Richmond Bottom Right 51.421213, -0.252830

    cycle.listfilesingeobox(lat1 = 51.421213, lat2 = 51.456435,long1 = -0.308058,long2 = -0.252830, inputpath = 'C:\\Users\\hanne\\PycharmProjects\\CycleStats\\CycleDataConverted\\', outputpath = 'C:\\Users\\hanne\\PycharmProjects\\CycleStats\\TestResults\\')
    cycle.listfilesingeobox(lat1 = 46.66600, lat2 = 46.66577,long1 = 6.316,long2 = 6.3158, inputpath = 'C:\\Users\\hanne\\PycharmProjects\\CycleStats\\TestResults\\', outputpath = 'C:\\Users\\hanne\\PycharmProjects\\CycleStats\\TestResults\\')


''' 
EAST SUSSEX CYCLING
===================
Top left : 
51.202986, -0.020553

Top right:
51.202986, 0.992632

Bottom left : 
50.693629,-0.020553

Bottom Right:
50.693629, 0.992632

cycle.listfilesingeobox(lat1 = 51.202986,
                        lat2 = 50.693629,
                        long1 = -0.020553,
                        long2 = 0.992632,
                        inputpath = '/Users/hbuhrmann/PycharmProjects/CycleStats/CycleDataConverted/',
                        outputpath = '/Users/hbuhrmann/PycharmProjects/CycleStats/TestResults/')

##### THE BELOW LIST IS FOR RICHMOND PARK

    filelist = [
    '_fit274359271.csv',
    '_gpx2638857863.csv',
    '_fit93303763.csv',
    '_fit417875520.csv',
    '_fit71329966.csv',
    '_fit155981351.csv',
    '_gpx2643914885.csv',
    '_fit41902202.csv',
    '_fit268071893.csv',
    '_fit186395269.csv',
    '_fit222172478.csv',
    '_fit609664351.csv',
    '_fit2622076061.csv',
    '_fit2820564841.csv',
    '_fit265445719.csv',
    '_fit268071928.csv',
    '_fit41902184.csv',
    '_fit2998662515.csv',
    '_fit55190542.csv',
    '_fit545815022.csv',
    '_fit1687732265.csv',
    '_fit81889899.csv',
    '_fit372779661.csv',
    '_fit81889202.csv',
    '_fit81889896.csv',
    '_fit56569576.csv',
    '_fit1875779766.csv',
    '_fit379926179.csv',
    '_fit2730598070.csv',
    '_fit444953718.csv',
    '_fit1637821946.csv',
    '_fit2730598108.csv',
    '_fit1795027684.csv',
    '_fit3011260406.csv',
    '_fit1655253755.csv',
    '_fit2662181279.csv',
    '_fit1687732213.csv',
    '_fit3011260343.csv',
    '_fit81889900.csv',
    '_tcx2823332114.csv',
    '_fit42107106.csv',
    '_fit222172487.csv',
    '_fit417875546.csv',
    '_fit3067188448.csv',
    '_fit42107099.csv',
    '_fit2754517140.csv',
    '_fit49690582.csv',
    '_fit274359163.csv',
    '_fit42205852.csv',
    '_fit41902152.csv',
    '_fit44645705.csv',
    '_fit1513269511.csv',
    '_fit1247766774.csv',
    '_fit55190559.csv',
    '_fit66160997.csv',
    '_fit282263387.csv',
    '_fit66161027.csv',
    '_fit43420884.csv',
    '_fit132521658.csv',
    '_fit271644817.csv',
    '_fit66161042.csv',
    '_fit78902817.csv',
    '_fit2998662501.csv',
    '_fit54229190.csv',
    '_fit186395255.csv',
    '_fit41902238.csv',
    '_fit41902169.csv',
    '_fit186395251.csv',
    '_fit81889936.csv',
    '_fit282263451.csv',
    '_fit66160999.csv',
    '_fit271644777.csv',
    '_fit68621510.csv',
    '_fit66161023.csv',
    '_fit54229191.csv',
    '_fit41902168.csv',
    '_fit44265870.csv',
    '_fit284678158.csv',
    '_fit186395254.csv',
    '_fit81889923.csv',
    '_fit54229193.csv',
    '_fit66161031.csv',
    '_fit92925572.csv',
    '_fit66161019.csv',
    '_fit67619365.csv',
    '_fit55190563.csv',
    '_fit92925422.csv',
    '_fit41902378.csv',
    '_fit81889958.csv',
    '_fit186395249.csv',
    '_fit282263441.csv',
    '_fit75406890.csv',
    '_fit282263424.csv',
    '_fit92925438.csv',
    '_fit41902151.csv',
    '_fit81889927.csv',
    '_fit171151363.csv',
    '_fit66161001.csv',
    '_fit81889205.csv',
    '_fit67619367.csv',
    '_fit81889956.csv',
    '_fit222172491.csv',
    '_fit337156476.csv',
    '_fit59064343.csv',
    '_fit67619366.csv',
    '_fit92925430.csv',
    '_fit171151368.csv',
    '_fit66161006.csv',
    '_fit337156378.csv',
    '_fit81889206.csv',
    '_fit292874656.csv',
    '_fit3011260386.csv',
    '_fit1497364505.csv',
    '_fit3013772727.csv',
    '_fit1655253848.csv',
    '_fit1687732301.csv',
    '_fit2713616191.csv',
    '_fit41902373.csv',
    '_fit1716079127.csv',
    '_fit417875533.csv',
    '_fit1655253803.csv',
    '_fit545815371.csv',
    '_fit2398259845.csv',
    '_fit1513269391.csv',
    '_fit1795027613.csv',
    '_fit2998857893.csv',
    '_fit1795027475.csv',
    '_fit1778970842.csv',
    '_fit1513269570.csv',
    '_fit1557815574.csv',
    '_fit2735961721.csv',
    '_fit2998662500.csv',
    '_fit1667605837.csv',
    '_fit1535437626.csv',
    '_fit1513270056.csv',
    '_fit1513269729.csv',
    '_fit1842312188.csv',
    '_fit1513269257.csv',
    '_fit1513270123.csv',
    '_fit2662181251.csv',
    '_fit1557815686.csv',
    '_fit1716079281.csv',
    '_fit372779572.csv',
    '_fit1667605872.csv',
    '_fit417875564.csv',
    '_fit1829128786.csv',
    '_fit3067188485.csv',
    '_fit1623327327.csv',
    '_fit2200716956.csv',
    '_fit1513269876.csv',
    '_fit372779603.csv',
    '_fit1637821759.csv',
    '_fit1703049855.csv',
    '_fit545815070.csv',
    '_fit2586527756.csv',
    '_fit1716079092.csv',
    '_fit2710795609.csv',
    '_fit2662181382.csv',
    '_fit1623327424.csv',
    '_fit1829128815.csv',
    '_fit1958496738.csv',
    '_fit1623327372.csv',
    '_fit1875779805.csv',
    '_fit1958496714.csv',
    '_fit292874565.csv',
    '_fit2998662524.csv',
    '_fit41902354.csv',
    '_fit3011260366.csv',
    '_fit41902204.csv',
    '_fit1703049514.csv',
    '_fit1637821962.csv',
    '_fit1623327495.csv',
    '_fit71855601.csv',
    '_fit262738022.csv',
    '_fit1493998906.csv',
    '_fit75406902.csv',
    '_fit68621511.csv',
    '_fit78902810.csv',
    '_fit1496720827.csv',
    '_fit41902200.csv',
    '_fit71855598.csv',
    '_fit1875779861.csv',
    '_fit59446755.csv',
    '_fit56569568.csv',
    '_fit2998662509.csv',
    '_fit1995166710.csv',
    '_fit1623327200.csv',
    '_fit92925516.csv',
    '_fit2430646648.csv',
    '_fit1778970761.csv',
    '_fit1703049600.csv',
    '_fit1716079201.csv',
    '_fit1716079202.csv',
    '_fit1703049642.csv',
    '_fit1778970281.csv',
    '_fit1667605910.csv',
    '_fit2213139198.csv',
    '_fit2213139157.csv',
    '_fit1778970739.csv',
    '_fit1703049536.csv'
    ]


#########    THE BELOW LIST IS FOR EAST SUSSEX ##########################################
pathname = '/Users/hbuhrmann/PycharmProjects/CycleStats/CycleDataConverted/'
filelist = [
'_fit316436609.csv',
'_fit314750266.csv',
'_fit235754964.csv',
'_fit292874968.csv',
'_fit132521637.csv',
'_fit174428563.csv',
'_fit320776083.csv',
'_fit314750502.csv',
'_fit314750657.csv',
'_fit434529725.csv',
'_fit92925470.csv',
'_fit314750835.csv',
'_fit2665288192.csv',
'_fit2754517219.csv',
'_fit316436588.csv',
'_fit229212343.csv',
'_fit75406895.csv',
'_fit41902330.csv',
'_fit41902255.csv',
'_fit271644920.csv',
'_fit179036708.csv',
'_fit41902387.csv',
'_fit66737350.csv',
'_fit41902172.csv',
'_fit44024127.csv',
'_fit92925484.csv',
'_fit41902234.csv',
'_fit92925563.csv',
'_fit204368754.csv',
'_fit271644947.csv',
'_fit265445729.csv',
'_fit43420889.csv',
'_fit429013665.csv',
'_fit92925478.csv',
'_fit52787078.csv',
'_fit92925530.csv',
'_fit81889914.csv',
'_fit41902310.csv',
'_fit190415250.csv',
'_fit203444225.csv',
'_fit337156571.csv',
'_fit92925453.csv',
'_fit66737316.csv',
'_fit429990832.csv',
'_fit51827785.csv',
'_fit70092189.csv',
'_fit2552738910.csv',
'_fit191388628.csv',
'_fit2398260144.csv',
'_fit2705294525.csv',
'_fit429013630.csv',
'_fit48623477.csv',
'_fit545815530.csv',
'_fit1024443285.csv',
'_fit1247767302.csv',
'_fit43420876.csv',
'_fit2452523671.csv',
'_fit41902281.csv',
'_fit41902167.csv',
'_fit616179786.csv',
'_fit2550104210.csv',
'_fit41902343.csv',
'_fit41902360.csv',
'_fit616179845.csv',
'_fit41902418.csv',
'_fit2432771829.csv',
'_fit81889907.csv',
'_fit1247767418.csv',
'_fit41902372.csv',
'_fit1875779694.csv',
'_fit132521643.csv',
'_fit2570074547.csv',
'_fit132521651.csv',
'_fit631757246.csv',
'_fit2564122774.csv',
'_fit222916009.csv',
'_fit207905635.csv',
'_fit337156544.csv',
'_fit262857121.csv',
'_fit47729142.csv',
'_gpxWindy_Morning_Ride.csv',
'_gpxWindy_Morning_Ride (1).csv',
'_fit1716079331.csv',
'_fit647504618.csv',
'_fit2820565050.csv',
'_fit41902422.csv',
'_fit1247767618.csv',
'_fit2531109046.csv',
'_fit1247767198.csv',
'_fit377021089.csv',
'_fit2449206576.csv',
'_fit616683920.csv',
'_fit47729150.csv',
'_fit229212358.csv',
'_fit444953730.csv',
'_fit1247767566.csv',
'_fit1751013743.csv',
'_fit204368743.csv',
'_fit401007730.csv',
'_fit2820564963.csv',
'_fit256420978.csv',
'_fit2457598697.csv',
'_fit253538033.csv',
'_fit662096823.csv',
'_fit1525290224.csv',
'_fit1024443226.csv',
'_fit1247767886.csv',
'_fit401007888.csv',
'_fit417875468.csv',
'_fit1247766712.csv',
'_fit41902340.csv',
'_fit174428583.csv',
'_fit1261644295.csv',
'_fit132521641.csv',
'_fit1247766150.csv',
'_fit171151354.csv',
'_fit41902161.csv',
'_fit1247768010.csv',
'_fit1247767496.csv',
'_fit41902228.csv',
'_fit609664370.csv',
'_fit609664368.csv',
'_fit1795027448.csv',
'_fit1857981254.csv',
'_fit314750224.csv',
'_fit545814898.csv',
'_fit282263511.csv',
'_fit1024443315.csv',
'_fit262738012.csv',
'_fit1024443393.csv',
'_fit132521652.csv',
'_fit1261644319.csv',
'_fit1247768072.csv',
'_fit1024443169.csv',
'_fit609664332.csv',
'_fit609664316.csv',
'_fit41902345.csv',
'_fit495298750.csv',
'_fit207905647.csv',
'_fit609664338.csv',
'_fit229212367.csv',
'_fit2531108987.csv',
'_fit546072723.csv',
'_fit41902419.csv',
'_fit1024443800.csv',
'_fit1829129118.csv',
'_fit545814954.csv',
'_fit262738005.csv',
'_fit1829129025.csv',
'_fit1538000242.csv',
'_fit51827772.csv',
'_fit50627481.csv',
'_fit395289966.csv',
'_fit561139947.csv',
'_fit1846012057.csv',
'_fit1846012148.csv',
'_fit2998662521.csv',
'_fit372779680.csv',
'_fit1247767246.csv',
'_fit401007761.csv',
'_fit429013645.csv',
'_fit1687732412.csv',
'_fit50627490.csv',
'_fit1879148194.csv',
'_fit1024443458.csv',
'_fit2998662532.csv',
'_fit609664375.csv',
'_fit609664323.csv',
'_fit545815148.csv',
'_fit545815478.csv',
'_fit92925549.csv',
'_fit70092200.csv',
'_fit2415615872.csv',
'_fit2998662514.csv',
'_fit1535437559.csv',
'_fit81889951.csv',
'_fit1247767005.csv',
'_fit545815454.csv',
'_fit325954809.csv',
'_fit2415615921.csv',
'_fit1257809360.csv',
'_fit662096842.csv',
'_fit401007814.csv',
'_fit1829129091.csv',
'_fit1879148151.csv',
'_fit624786858.csv',
'_fit1958497095.csv',
'_fit51827795.csv',
'_fit48623471.csv',
'_fit2757749280.csv',
'_fit92925536.csv',
'_fit75406909.csv',
'_fit2570074449.csv',
'_fit1829129036.csv'
]

#cycledf = cycle.readcyclecsv(pathname,filelist)
#cycledf.to_csv('/Users/hbuhrmann/PycharmProjects/CycleStats/TestResults/east_sussex.csv')

'''


runStep2()